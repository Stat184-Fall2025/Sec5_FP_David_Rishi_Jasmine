---
title: "Final Project"
subtitle: "STAT 184"
author: "David Goldberg, Jasmine Randhawa, Rishi Lal"
date: "Monday, December 15, 2025"
format:
  pdf:
    toc: false
    number-sections: false
    margin-left: 1in
    margin-right: 1in
    margin-top: 1in
    margin-bottom: 1in
execute:
  echo: false
  eval: true
  warning: false
  message: false
engine: knitr
---

# Introduction

The focus of our group project is to look into how Apple's supplier companies stock performances affect Apple's stock. We decided to look at 4 of Apple's main suppliers: Foxconn, Pegatron, Compal, and TSMC. All of these companies are based in Taiwan, and they also supply other companies with microchips and other parts. Our goal is to see whether or not there is a relationship between these stocks and Apple's, in order to see if we can use that to predict if Apple's stock performance will go up or down.

## The Dataset

We got the data for our project from the tidyquant R package. The tidyquant package is used to retrieve data about the stock market from the web (more specifically, Yahoo Finance). Using this package we decided to pull stock information about the 5 companies we're analyzing from 2022 to the present.

### FAIR and CARE Principles

The data that we pulled from the tidyquant package follows both the FAIR and CARE principles. The FAIR principles state that data must be findable, accessible, interoperable, and reusable; while the CARE principles emphasis that data should provide collective benefit, authority to control, responsibility, and ethics.

I need to find my notes from this day, so I'll add more to this section later.

## Methods

This section will explain the normalization and cumulative growth.

# Results

## Tables

### Apple's Recent Trading Data

This table provides information about Apple's most recent trading activity, including the daily open, high, low, close, and trading volume for the last five trading days.  This lets us see short-term fluctuations in Apple's stock price.

During this time, Apple's stock remained stable and fluctuated from $271 to $280.  The most notable event was when Apple opened at $280.15 on December 15th, and then dipped to $274.11 at the end of the day.  December 15th was also when the highest volume occurred, with over 50 million shares.  Still, Apple's stock remains quite stable and only shows minor ups and downs.

```{r}
# Rename columns to be capitalized for a professional look.
table_sample <- apple_data %>%
  tail(5) %>%                                      # Select only the last 5 rows
  select(date, open, high, low, close, volume) %>% # Keep only essential columns
  mutate(date = format(date, "%B %d, %Y")) %>%     # Format date nicely (e.g., "Jan 01, 2024")
  rename(                                          # Rename columns for display
    "Date"   = date,
    "Open"   = open,
    "High"   = high,
    "Low"    = low,
    "Close"  = close,
    "Volume" = volume
  )

# 'scale_down' automatically shrinks the table if it's too wide for the PDF margin.
# 'hold_position' forces the table to appear exactly where you put the code, not floating away.
kbl(table_sample, caption = "Table 1: Recent Apple (AAPL) Stock Performance", booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale_down", "hold_position")) %>%
  column_spec(1, bold = TRUE) # Make the Date column bold
```


### Normalized Percent Change Comparison Table

This table shows how Apple and it's key suppliers' stock prices changed over time, by using normalized percent change.  By setting each stock's starting value to 0%, we can compare their movements, despite the fact that the stock prices are quite varied.


```{r}
normalized_data %>%
kable(
  caption = "<center>Supplier Performance affects on Apple stock<center/>",
  align = c("l", rep("c",7))
)%>%
  kable_classic( # Pre-built styling
    font_size = 16, # Control Font Size
    lightable_options = "striped" # Adds striping in a pre-built table style
  )
```

### Annual Total Returns

This table summarizes the total yearly return from 2022 to 2025 for Apple, Foxconn, TSMC, Compal, and Pegatron.  The returns are showed as percentages, and are calculated from the difference between the first and last adjusted closing price of the year.  Doing this lets us see the difference in performance between the companies, regardless of their stock price.

2022 was the worst year, with Apple and most of its suppliers having negative returns.  Only Compal had a small positive return of +3.0%.  In 2023, companies started to improve with Apple gaining 54.8% and Compal rising by 80.2%.  During 2024, stock performance was mixed but still mainly positive.  TSMC and Foxconn did very well, with total returns of 97.3% and 73.3%.  However, Compal started to slip with a return of -1.7%.  In 2025, returns were more moderate with only Apple, Foxconn, and TSMC having decent positive returns (32.4%, 32.4%, 44.2%).  However, both Pegtron and Compal declined.

Apple's performance moved in the same direction as its suppliers, but to varying extents.  2023 and 2024 were strong years that likely had widespread industry growth, while external events in 2022 and 2025 (COVID, AI boom) led to some suppliers struggling, even when Apple had a positive performance.

```{r}
# Annual Return Table
annual_return_table <- annual_summary %>%
  mutate(
    total_return_pct = scales::percent(total_return, accuracy = 0.1)
  ) %>%
  select(symbol, year, total_return_pct) %>%  # Keep only the formatted column
  arrange(year, symbol)

# Create a styled table
kbl(
  annual_return_table,
  caption = "Annual Total Returns for Apple and Suppliers",
  col.names = c("Symbol", "Year", "Total Return (%)"),
  align = c("c","c","c"),
) %>%
  kable_styling() %>%
  column_spec(1, bold = TRUE)   # Bolds the ticker column
```


## Visualizations

### Normalized Performance Line Chart

The normalized line chart shows how Apple and its suppliers' stocks have performed since their starting values in 2022.

TSMC (TSM) had the greatest overall growth, and had a steep upward trend that began in 2024. However, TSMC also had the worst normalized stock performance from 2022 until 2024. This suggest that TSMC was likely hit the hardest of the suppliers by COVID-19, and it's strong performance came as a result from increased demand for semiconductors and its role in the current AI boom.

Foxconn (HNHPF) also demonstrates significant growth from 2024 and onward. It's percent change is very close to TSMC and it's stock didn't drop as much as TSMC from 2022 to 2024. This is likely due to Foxconn being Apple's main supplier for assembly.

Pegatron (4938.TW) and Compal (2324.TW) had moderate growth, which then dipped in 2025. This suggests that they have a slower recovery compared to TSMC and Foxconn and are likely not involved with AI.

Apple (AAPL) remains relatively stable and has had a decent upward trend. It's much less volatile than its suppliers, which is likely due to its presence in multiple markets and that Apple is an established company.

The difference in stock performance shows that supplier stocks can outperform Apple's stock in relative terms, especially in growth phases. Currently, AI is being heavily invested in and supplier companies that produce things for AI can experience a lot of growth. TSMC and Foxconn are the most dynamic of the supplier stocks, and can offer predictive insight for Apple's performance.

```{r}
ggplot(normalized_data, aes(x = date, y = percent_change, color = symbol)) + 
  geom_line(linewidth = .5) +
  labs(title = "Normalized Stock Performance",
       x = "Date",
       y = "Percent Change",
       color = "Stock") + 
  theme_minimal()
```

### Normalized Apple and Foxconn Stock Performance

Looking at the previous graph, we concluded that both Foxconn and TSMC could have predictive value for Apple. We decided to look into the relationship between Foxconn and Apple since Foxconn is a larger supplier to Apple than TSMC.

Foxconn is more volatile than Apple, and starting in early 2024 has much sharper swings in percent change. At this time, its percent change also surpasses Apple's. Despite having a lower stock price, Foxconn has stronger relative growth.

The difference in volatility between Apple and Foxconn indicates that Foxconn is more sensitive to demand and supply chain pressures. Foxconn's performance can potentially change before Apple's. Foxconn trended upwards before Apple followed suit in both early 2024 and 2025, which supports the idea that supplier stocks can be leading indicators in performance. However, Apple's steadiness and modest fluctuations also implies that supplier volatility doesn't always directly translate into Apple's performance.

```{r}
ggplot(normalized_data_small, aes(x = date, y = percent_change, color = symbol)) + 
  geom_line(linewidth = .5) +
  labs(title = "Normalized Stock Performance",
       x = "Date",
       y = "Percent Change",
       color = "Stock") + 
  theme_minimal()
```

### Annual Growth Line Plot

This visualization shows how Apple's stock performance compares with it's suppliers every year. We plotted cumulative returns for each company, and reset their performance to 0% at the start of each year. This way, we can look at how each stock changes across different market conditions.

In 2022, none of the stocks performed particularly well. Cumulative returns ranged from around 0% to -40% at the end of the year.

2023 is when most of the companies started recovering and experiencing strong growth. Compal had the most growth, with cumulative returns at the end of the year reaching 80%. Foxconn, however, remained flat this year despite Apple's surge. This suggests that not all of the suppliers immediately respond to Apple's growth.

Unlike in 2023, Foxconn had a dramatic rise in 2024, which peaked around 120% in the middle of the year before it stabilized. This likely reflects either an increase in production or a shift in its operations. In 2024, TSMC also continued its upward growth from the previous year while Apple, Compal, and Pegatron's growth remained more flat and stable.

In 2025, both Compal and Pegatron's performance dipped and they are both ending the year with a cumulative return of around -20%. Apple maintained a mild and steady growth, while TSMC and Foxconn experienced stronger growth (despite a dip earlier in the year).

By looking at these plots, we can see that TSMC consistently tracks Apple's performance while also often having stronger returns. Foxconn's growth was more delayed than TSMC's but still managed to have strong growth in 2024 and 2025, which suggests that it responds to Apple's demand cycles more slowly (which could offer predictive value). Pegatron and Compal's performances are less aligned with Apple, which indicates that they have less influence on Apple's stock or are less responsive.

```{r}
line_plot <- ggplot(yearly_growth, aes(x = date, y = pct_change, color = symbol)) +
  geom_line(linewidth = 0.8) +
  facet_wrap(~ year, scales = "free", ncol = 2) +
  scale_y_continuous(labels = percent_format()) +
  theme_tq() +
  scale_color_tq() +
  labs(
    title = "Apple vs. Suppliers: Yearly Growth",
    subtitle = "Performance reset to 0% at the start of each year",
    y = "Cumulative Return",
    x = "",
    color = "Ticker"
  ) +
  theme(legend.position = "bottom")

print(line_plot) # This will result in the line plot for every year.
```

### Annual Returns Bar Chart

The bar chart below summarizes the total annual return for Apple and its four main suppliers from 2022 to the present.  Each bar represents the percent change in __ from the beginning to the end of the year.

2022 was a difficult year for every company, which correlates to how the tech market was still recovering from the effects of COVID-19.  2023 was when the Apple and its supplier companies started to rebound.  Compal and Apple had the strongest performance.  In 2024, growth slowed for Pegatron and Compal while Apple maintained solid growth.  TSMC and Foxconn surged, likely due to increased demand or changes in operations.  During 2025, Apple and its two main suppliers still grew, but at a more modest rate.  Pegatron and Compal declined, likely due to a lack of demand and a lull in sales for non-AI technology.

```{r}
bar_plot <- ggplot(annual_summary, aes(x = symbol, y = total_return, fill = symbol)) +
  geom_col(color = "black", alpha = 0.8) +
  facet_wrap(~ year, ncol = 2) +
  geom_text(aes(label = percent(total_return, accuracy = 1)), 
            vjust = -0.5, size = 3, fontface = "bold") +
  scale_y_continuous(labels = percent_format(), expand = expansion(mult = c(0.1, 0.2))) +
  scale_fill_tq() +
  theme_tq() +
  labs(
    title = "Total Return for Each Year",
    y = "Total % Change",
    x = ""
  ) +
  theme(legend.position = "none")

print(bar_plot) # This will result in the bar plot for every year.
```

# Discussion

## Relationship Between Apple and Suppliers

Apple's stock performance isn't perfectly correlated with the suppliers. While suppliers do provide Apple with necessary components for manufacturing their products, their stock movements also depend on the broader semiconductor and electronics market.

## Predictive Value

Supplier stocks can provide early indicators of Apple's stock performance, especially the larger companies that have greater revenues. However, product launches, global demand, and brand perceptions also play a large role in Apples performance.

## Limitations

The data that we collected is limited from 2022 to the present, so it may not catch long-term patterns and cycles. Supplier stocks can also be influenced by clients other than Apple, so they aren't always reliable.

# Conclusion

# Code Appendix

```{r codeAppendix}
#| ref.label = knitr::all_labels(),
#| echo = TRUE,
#| eval = FALSE

# Load necessary libraries
library(dplyr)
library(tidyquant)
library(ggplot2)
library(scales) # Useful in formatting
library(lubridate) # Allows us to work with dates easily
library(kableExtra)
library(knitr)

# Add tickers for Apple, Foxconn, TSMC, Pegatron, and Compal
# AAPL    = Apple Inc.
# HNHPF   = Hon Hai Precision (Foxconn) - OTC US listing
# TSM     = Taiwan Semiconductor - NYSE ADR
# 4938.TW = Pegatron Corp - Taiwan Stock Exchange
# 2324.TW = Compal Electronics - Taiwan Stock Exchange

tickers <- c("AAPL","HNHPF", "TSM", "4938.TW", "2324.TW")
tickers_small <- c("AAPL", "HNHPF")

# Start from Jan 1, 2022
start_date <- "2022-01-01"
end_date   <- Sys.Date() # Today

#Get the daily stock price data from Yahoo Finance.
stock_data <- tq_get(tickers, 
                     get  = "stock.prices", 
                     from = start_date, 
                     to   = end_date)

stock_data_small <- tq_get(tickers_small, 
                           
                     get  = "stock.prices", 
                     from = start_date, 
                     to   = end_date)


"I normalized the data b/c APPL stock price is over 100 and HNHPF is less than 10, 
so we wont be able to see the couple cent changes in foxconn and comparison to the dollar changes in APPL.
In other words HNHPF will look like a flat line even when APPL in visually moving up and down."


normalized_data <- stock_data %>%
  select(symbol, date, adjusted) %>%
  group_by(symbol) %>%
  arrange(date) %>%
  mutate(
    percent_change = ((adjusted / first(adjusted) - 1)*100)
         ) 

normalized_data_small <- stock_data_small %>%
  select(symbol, date, adjusted) %>%
  group_by(symbol) %>%
  arrange(date) %>%
  mutate(
    percent_change = ((adjusted / first(adjusted) - 1)*100)
  ) 


# Fetch Data (if you haven't already)
apple_data <- tq_get("AAPL", get = "stock.prices", from = "2023-01-01")

# Rename columns to be capitalized for a professional look.
table_sample <- apple_data %>%
  tail(5) %>%                                      # Select only the last 5 rows
  select(date, open, high, low, close, volume) %>% # Keep only essential columns
  mutate(date = format(date, "%B %d, %Y")) %>%     # Format date nicely (e.g., "Jan 01, 2024")
  rename(                                          # Rename columns for display
    "Date"   = date,
    "Open"   = open,
    "High"   = high,
    "Low"    = low,
    "Close"  = close,
    "Volume" = volume
  )

# 'scale_down' automatically shrinks the table if it's too wide for the PDF margin.
# 'hold_position' forces the table to appear exactly where you put the code, not floating away.
kbl(table_sample, caption = "Table 1: Recent Apple (AAPL) Stock Performance", booktabs = T) %>%
  kable_styling(latex_options = c("striped", "scale_down", "hold_position")) %>%
  column_spec(1, bold = TRUE) # Make the Date column bold

normalized_data %>%
kable(
  caption = "<center>Supplier Performance affects on Apple stock<center/>",
  align = c("l", rep("c",7))
)%>%
  kable_classic( # Pre-built styling
    font_size = 16, # Control Font Size
    lightable_options = "striped" # Adds striping in a pre-built table style
  )

# Annual Return Table
annual_return_table <- annual_summary %>%
  mutate(
    total_return_pct = scales::percent(total_return, accuracy = 0.1)
  ) %>%
  select(symbol, year, total_return_pct) %>%  # Keep only the formatted column
  arrange(year, symbol)

# Create a styled table
kbl(
  annual_return_table,
  caption = "Annual Total Returns for Apple and Suppliers",
  col.names = c("Symbol", "Year", "Total Return (%)"),
  align = c("c","c","c"),
) %>%
  kable_styling() %>%
  column_spec(1, bold = TRUE)   # Bolds the ticker column

# Line chart
ggplot(normalized_data, aes(x = date, y = percent_change, color = symbol)) + 
  geom_line(linewidth = .5) +
  labs(title = "Normalized Stock Performance",
       x = "Date",
       y = "Percent Change",
       color = "Stock") + 
  theme_minimal()


ggplot(normalized_data_small, aes(x = date, y = percent_change, color = symbol)) + 
  geom_line(linewidth = .5) +
  labs(title = "Normalized Stock Performance",
       x = "Date",
       y = "Percent Change",
       color = "Stock") + 
  theme_minimal()


# Prepare Cumulative Growth chart
yearly_growth <- stock_data %>% # Using the stock data from above.
  mutate(year = year(date)) %>% # mUtates the data, new column called year
  group_by(symbol, year) %>%
  mutate(
    # Reset growth to 0% at start of every year
    pct_change = (adjusted / first(adjusted)) - 1
  ) %>%
  ungroup()

# B. Total Annual Return for the Bar Chart
annual_summary <- stock_data %>%
  mutate(year = year(date)) %>%
  group_by(symbol, year) %>%
  summarize(
    total_return = (last(adjusted) - first(adjusted)) / first(adjusted),
    .groups = "drop"
  )

# Plot-1: Line Chart
line_plot <- ggplot(yearly_growth, aes(x = date, y = pct_change, color = symbol)) +
  geom_line(linewidth = 0.8) +
  facet_wrap(~ year, scales = "free", ncol = 2) +
  scale_y_continuous(labels = percent_format()) +
  theme_tq() +
  scale_color_tq() +
  labs(
    title = "Apple vs. Suppliers: Yearly Growth",
    subtitle = "Performance reset to 0% at the start of each year",
    y = "Cumulative Return",
    x = "",
    color = "Ticker"
  ) +
  theme(legend.position = "bottom")

print(line_plot) # This will result in the line plot for every year.

# Plot-2: Bar Chart
bar_plot <- ggplot(annual_summary, aes(x = symbol, y = total_return, fill = symbol)) +
  geom_col(color = "black", alpha = 0.8) +
  facet_wrap(~ year, ncol = 2) +
  geom_text(aes(label = percent(total_return, accuracy = 1)), 
            vjust = -0.5, size = 3, fontface = "bold") +
  scale_y_continuous(labels = percent_format(), expand = expansion(mult = c(0.1, 0.2))) +
  scale_fill_tq() +
  theme_tq() +
  labs(
    title = "Total Return for Each Year",
    y = "Total % Change",
    x = ""
  ) +
  theme(legend.position = "none")

print(bar_plot) # This will result in the bar plot for every year.
```
